\documentclass[12pt]{article}



\usepackage{t1enc}
\usepackage[utf8]{inputenc}
\usepackage[magyar]{babel}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{mathtools}
\usepackage[shortlabels]{enumitem}
\usepackage[autostyle]{csquotes}
\usepackage{graphicx}
\usepackage{mathrsfs}



\selectlanguage{magyar}

\DeclareQuoteAlias{dutch}{magyar}

\theoremstyle{definition}
\newtheorem{definition}{Definíció}
\newtheorem*{definition*}{Definíció}

\theoremstyle{remark}
\newtheorem{remark}{Megjegyzés}
\newtheorem*{remark*}{Megjegyzés}

\theoremstyle{plain}
\newtheorem{theorem}{Tétel}
\newtheorem*{theorem*}{Tétel}

\theoremstyle{remark}
\newtheorem{corollary}{Következmény}
\newtheorem*{corollary*}{Következmény}

\theoremstyle{plain}
\newtheorem{lemma}{Lemma}
\newtheorem*{lemma*}{Lemma}

\let\oldemptyset\emptyset
\let\emptyset\varnothing

\newcommand{\forwardhat}{\overset{\rightharpoonup}}
\newcommand{\backwardhat}{\overset{\leftharpoonup}}

\newcommand{\inc}{\textit{inc}}
\newcommand{\dec}{\textit{dec}}

\newcommand{\en}{\textit{en}}
\newcommand{\res}{\textit{res}}
\newcommand{\ip}{\textit{ip}}
\newcommand{\excl}{\; \textit{excl} \;}
\newcommand{\incl}{\; \textit{incl} \;}

\newcommand{\reaction}[3]{
    (#1, \, #2, \, #3)
}

\graphicspath{ {./images/} }



\title{Reverzibilis Reaction System}
\date{\today}

\begin{document}
    \maketitle

    \section*{Előzetes ismeretek}

    A következőkben bevezetjük azokat a \textit{reaction systemekkel} kapcsolatos jelöléseket, melyekre a továbbiakban támaszkodni fogunk. Ezek között megtalálható néhány új jelölés is, mely eddigi cikkekben nem szerepelt, azonban jelentősen leegyszerűsíti a későbbi definíciókat.

    \begin{definition}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system}. Egy $\mathscr{A}$-beli \textit{interactive process} véges sorozatok olyan $\pi = (\gamma, \delta)$ párja, amelyben $\gamma = C_{0}, C_{1}, \ldots C_{n}$, $\delta = D_{1}, \ldots D_{n}$, $n \geq 1$, ahol $C_{0}, \ldots C_{n}$, $D_{1}, \ldots D_{n} \subseteq S$, $D_{1} = \textit{res}_{\mathscr{A}}(C_{0})$ és $D_{i} = \textit{res}_{\mathscr{A}}(D_{i - 1} \cup C_{i - 1})$, ha $2 \leq i \leq n$.
    \end{definition}

    \begin{definition}
        Legyen $a = \reaction{R_{a}}{I_{a}}{P_{a}}$ egy reakció, $T$ pedig egy véges halmaz. Azt mondjuk, hogy $a$ alkalmazható $T$-re, ha $R_{a} \subseteq T$ és $I_{a} \cap T = \emptyset$. Erre a továbbiakban az $\en_{a}(T)$ jelölést használjuk. Az $a$ reakció által a $T$ halmazból képzett eredményhalmazt $\res_{a}(T)$ módon jelöljük, és a következőképpen definiáljuk: $\res_{a}(T) = P_{a}$, ha $\en_{a}(T)$, egyébként pedig $\res_{a}(T) = \emptyset$.
    \end{definition}

    \begin{remark*}
        A következőkben, az egyszerűbb olvashatóság érdekében, feltesszük, hogy ha adott egy $a \in A$ reakció, akkor annak komponenseit $a$ alsó indexbe helyezésével helyezésével jelöljük, az $a = \reaction{R_{a}}{I_{a}}{P_{a}} \in A$ kifejezés kiírása nélkül.
    \end{remark*}

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza és $T$ egy véges halmaz. Ekkor az $A$ reakcióhalmaz $T$-re való alkalmazásának eredménye $\res_{A}(T) = \bigcup_{a \,\in\, A}\res_{a}(T)$.
    \end{definition}

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza és $T$ egy véges halmaz. Jelölje ekkor $\textit{RES}_{A}(T)$ azt a halmazt, mely az összes, $T$-ből $A$-beli reakciók alkalmazásával előállítható eredményhalmazt tartalmazza, azaz $\textit{RES}_{A}(T) = \{ \, \res_{A}(W) \; \mid \; W \subseteq T\, \}$
    \end{definition}

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza és $T$ egy véges halmaz. $A$ azon részhalmazát, mely csak olyan reakciókat tartalmaz, melyek alkalmazhatók $T$-re, $\en_{A}(T)$ módon jelöljük.
    \end{definition}

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza és $T$ egy véges halmaz. Jelölje ekkor $\textit{EN}_{A}(T)$ azon különböző reakcióhalmazokat, melyek alkalmazhatók $T$ valamely részhalmazára, azaz
        \begin{align*}
            \textit{EN}_{A}(T) = \{ B \;|\; B \subseteq A \wedge \exists\,S \subseteq T : \en_{B}(S) = B \}.
        \end{align*}
        Az $\textit{EN}_{A}(T)$ halmazra gondolhatunk úgy, hogy reakciócsoportokat tartalmaz. Minden ilyen reakciócsoport olyan reakciókat foglal magában, melyek $T$-nek valamely részére együttesen alkalmazhatók.
    \end{definition}

    \begin{remark*}
        A továbbiakban, az általánosság elvesztése nélkül, kizárólag olyan $\mathscr{A} = (S, A)$ \textit{reaction systemeket} fogunk tekinteni, melyek nem tartalmaznak azonos feltételek mellett alkalmazható reakciókat. Ez azt jelenti, hogy nincs két olyan $a, b\in A$ ($a \neq b$) reakció, melyekre teljesülne, hogy $R_{a} = R_{b}$ és $I_{a} = I_{b}$. Az ilyen $a, b$ reakciókat ugyanis egyszerűen összevonhatjuk egy $c$ reakcióvá, ahol $c = (R_{a}, I_{a}, P_{a} \cup P_{b})$.
    \end{remark*}    

    \section*{Reverzibilis Reaction System}

    A vizsgálódásaink előtt be kell vezetnünk a reverzibilitás fogalmát a \textit{reaction systemekre} vonatkozóan. Ehhez  először az egyes \textit{interactive processekre} adjuk meg a reverzibilitás jelentését. A következő definíció azt az intuíciót formalizálja, miszerint akkor tudunk visszalépni a megelőző állapotba, ha az aktuális állapotunk csak egyetlen állapotból képződhetett. Azaz, nincs lehetőségünk kettő vagy több különböző állapotból elérni pontosan ugyanabba az állapotba.

    \begin{definition}\label{def:reversible-interactive-process}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system}, $\pi=(\gamma, \delta)$ pedig egy \textit{interactive process} $\mathscr{A}$-ban a $\gamma = C_{0}, C_{1}, \ldots C_{n}$, bemeneti halmazokkal és $\textit{sts}(\pi)=W_{0},W_{1},\ldots W_{n}$ állapothalmazokkal. $\pi$ reverzibilis, amennyiben minden $W_{i}$ ($1 \leq i \leq n$) állapotára teljesül, hogy ha $W \subseteq S$ olyan, hogy $res_{\mathscr{A}}(W) \cup C_{i} = W_{i}$, akkor $W = W_{i - 1}$.
    \end{definition}

    A fenti definícióban kulcsfontosságú a bemeneti halmazok ($C_{i}$) szerepe. Nem elég ugyanis, hogy az aktuális eredményhalmaz (mely halmazokat $D_{i}$ módon szoktuk jelölni, azonban a definícióban $\res_{\mathscr{A}}(W)$ módon jelenik meg) egyértelműen előállítható. Önmagában ez az egyértelműség ugyanis a bemeneti halmazzal még elrontható: az eredményhalmazt egy olyan bemenettel párosítjuk, mely egy másik lehetséges eredményhalmaznak felel meg. Ennek folytán az eredményhalmaznak és a hozzá társuló bemenetnek ($\res_{\mathscr{A}}(W) \cup C_{i}$) kell együttesen egyedinek lenni.

    \begin{definition}\label{def:reversible-reaction-system}
        Egy $\mathscr{A}$ \textit{reaction system} reverzibilis, amennyiben minden $\mathscr{A}$-beli $\pi$ \textit{interactive process} reverzibilis.
    \end{definition}

    Már a \ref{def:reversible-interactive-process}. definícióban megfogalmazott reverzibilis \textit{interactive process} fogalom is függött a bemenettől. Mivel a \ref{def:reversible-reaction-system}. definíciót az \textit{interactive processek} reverzibilitására építve adtuk meg, ezért sejthető, hogy szoros összefüggés van a bemenet milyensége és a reverzibilitás között. Ebből kifolyólag további jelöléseket vezetünk be a \textit{reaction systemek} háttérhalmazára (\textit{background set}) vonatkozóan, kihangsúlyozva a lehetséges bemeneteket.

    \begin{remark*}
        A következőkben feltesszük, hogy egy $\mathscr{A} = (S, A)$ \textit{reaction system} $S$ háttérhalmazát (\textit{background set}) megadhatjuk két (nem feltétlenül diszjunkt) halmaz uniójaként: $S = \Sigma_{p} \cup \Sigma_{c}$. Jelölje ekkor $\Sigma_{p}$ azon elemek halmazát, melyek előállhatnak valamely $A$-beli reakció alkalmazásával, azaz $\Sigma_{p} = \bigcup_{a \, \in \, A}P_{a}$. Jelölje továbbá $\Sigma_{c}$ azon elemek halmazát, melyek szerepelhetnek valamilyen $A$-beli \textit{interactive process} valamely bemeneti halmazában. Utóbbi azt jelenti, hogy korlátozható azon elemek halmaza, melyek bemenetként megjelenhetnek.
    \end{remark*}

    Továbblépve, megkíséreljük körülírni, hogy mely tulajdonságok teljesülése esetén lehet egy \textit{reaction system} reverzibilis.

    Érdemes a legegyszerűbbel kezdeni: tegyük fel, hogy van egy olyan állapotunk, melyre csak olyan reakciók alkalmazhatók, melyek nem használják fel az állapot összes elemét. Azaz, úgy tűnnek el elemek, hogy nem vesznek részt semmilyen új elem létrehozásában. Jogosnak tűnik egy olyan felvetés, hogy ha vannak ilyen, lényegében nyom nélkül eltűnő elemek, akkor nem beszélhetünk reverzibilitásról.

    \begin{lemma}\label{lem:no-disappearing-elements}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system}, $\pi$ pedig egy \textit{interactive process} $\mathscr{A}$-ban az $\textit{sts}(\pi)=W_{0},W_{1},\ldots W_{n}$ állapothalmazokkal. $\pi$ csak akkor lehet reverzibilis, ha az állapothalmazainak minden eleme részt vesz valamilyen reakcióban, azaz $\bigcup_{a \in \textit{en}(W_{i})} R_{a} = W_{i}$, $i \leq n$.
    \end{lemma}

    \begin{proof}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system} és $\pi=(\gamma, \delta)$ egy \textit{interactive process} $\mathscr{A}$-ban a $\gamma = C_{0}, C_{1}, \ldots C_{n}$, bemeneti halmazokkal és az $\textit{sts}(\pi)=W_{0},W_{1},\ldots W_{n}$ állapothalmazokkal. Legyen $W_{i - 1} \subseteq S$ és $W_{i} \subseteq S$ $\pi$ két egymást követő állapothalmaza, azaz $\res_{A}(W_{i-1}) \cup C_{i}=W_{i}$.
        
        Tegyük fel, hogy van olyan elem a $W_{i-1}$ halmazban, mely nem vesz részt egy reakcióban sem:
        \begin{align*}
            \bigcup_{a \,\in\, \textit{en}(W_{i-i})} R_{a} \subset W_{i-1}.
        \end{align*}
        Ez pontosan azt jelenti, hogy létezik egy olyan $W \subset S$ halmaz, mely
        \begin{align*}
            W = \bigcup_{a \,\in\, \textit{en}(W_{i-i})} R_{a}
        \end{align*}
        módon adott, és melyre teljesül, hogy
        \begin{align*}
            \res_{A}(W) \cup C_{i} = W_{i}.
        \end{align*}

        Ekkor $\pi$ biztosan nem lehet reverzibilis, hiszen $W \neq W_{i - 1}$, viszont $W_{i} = \res_{A}(W) \cup C_{i} = \res_{A}(W_{i - 1}) \cup C_{i}$.
    \end{proof}

    Az \textit{interactive processek} reverzibilitásáról szóló \ref{def:reversible-interactive-process}. definíció szerint a bemenetek befolyásolják egy \textit{reaction system} reverzibilitását. Egészen pontosan, nem elég, ha az egyes eredményhalmazok egyediek (azaz, egyértelműen előállíthatók), szükséges az is, hogy bemenettel ne lehessen ezt az egyediséget semmissé tenni. Bizonyosnak látszik tehát, hogy egy \textit{reaction system} reverzibilitásához szükség van erre a tulajdonságra is, azaz, hogy egy eredményhalmaz bemenettel párosítva is egyedi legyen. Itt fog szerephez jutni a háttérhalmaz szétválasztása két, nem feltétlenül diszjunkt halmazra.

    \begin{lemma}\label{lem:unique-results}
        Legyen $\mathscr{A} = (S, A)$ ($S = \Sigma_{p} \cup \Sigma_{c}$, ahol ezek nem feltétlenül diszjunkt halmazok) egy \textit{reaction system}, $\mathcal{D} \subseteq \mathcal{P}(S)$ pedig a következő módon adott:
        \begin{align*}
            \mathcal{D} = \{ \, R \setminus \Sigma_{c} \mid R \in \textit{RES}_{A}(S) \, \}.
        \end{align*}
        Azaz, vesszük az összes, $S$-ből $A$-beli reakciókkal előállítható halmazt, majd ezekből kivesszük a lehetséges bemeneti szimbólumokat ($\Sigma_{c}$ elemeit).
        $\mathscr{A}$ csak akkor lehet reverzibilis, ha nincs két olyan eredményhalmaz, mely között csak bemeneti elemek tettek különbséget:
        \begin{align*}
            |\,\mathcal{D}\,| = |\,\textit{RES}_{A}(S)\,|.
        \end{align*}
    \end{lemma}

    \begin{proof}
        Legyen $\mathscr{A} = (S, A)$ ($S = \Sigma_{p} \cup \Sigma_{c}$) egy \textit{reaction system}. Tegyük fel, hogy 
        \begin{align*}
            |\,\mathcal{D}\,| \neq |\,\textit{RES}_{A}(S)\,|.
        \end{align*}
        Ekkor $\mathcal{D}$ felírásából adódóan biztos, hogy
        \begin{align*}
            |\,\mathcal{D}\,| < |\,\textit{RES}_{A}(S)\,|.
        \end{align*}
        Ez azt jelenti, hogy létezik $D_{i}, D_{j} \in \textit{RES}_{A}(S)$ ($D_{i} \neq D_{j}$), hogy
        \begin{align*}
            D_{i} \setminus \Sigma_{c} = D_{j} \setminus \Sigma_{c}.
        \end{align*}
        Mivel $D_{i}$ és $D_{j}$ elemei a $\textit{RES}_{A}(S)$ halmaznak, ezért léteznek olyan $W_{i}, W_{j} \subseteq S$ ($W_{i} \neq W_{j}$, hiszen különböző eredményhalmazok csak különböző állapothalmazókból állíthatók elő, azonos reakciók esetén) halmazok, hogy $\res_{A}(W_{i}) = D_{i}$ és $\res_{A}(W_{j}) = D_{j}$. Továbbá, mivel $D_{i} \neq D_{j}$, azonban $D_{i} \setminus \Sigma_{c} = D_{j} \setminus \Sigma_{c}$, ezért $C$-t olyannak választva, hogy $C = (D_{i} \cap \Sigma_{c}) \cup (D_{j} \cap \Sigma_{c})$, teljesül, hogy
        \begin{align*}
            D_{i} \cup C = D_{j} \cup C.
        \end{align*}
        Ezen állítások azt jelentik, hogy létezik $W_{i}, W_{j} \subseteq S$ ($W_{i} \neq W_{j}$) és $C \subseteq \Sigma_{c}$ úgy, hogy
        \begin{align*}
            \res_{A}(W_{i}) \cup C = \res_{A}(W_{j}) \cup C,
        \end{align*}
        azaz $\mathscr{A}$ nem reverzibilis.
    \end{proof}     

    Az elemek nyom nélküli eltűnését tiltó \ref{lem:no-disappearing-elements}. lemmában már érintőlegesen foglalkoztunk a reakciókkal. Most vegyük elő őket újra, ezúttal részletesebben. Tudjuk, hogy egy \textit{reaction system} biztosan nem lehet reverzibilis, ha egy eredményhalmaz több különböző állapothalmazból is előállítható. Mivel az eredményhalmazok reakciók útján jönnek létre, ebből formalizálhatunk egy, a reakciókra vonatkozó követelményt.

    \begin{lemma}\label{lem:unique-products}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system}. $\mathscr{A}$ csak akkor lehet reverzibilis, ha egyértelmű, hogy egy eredményhalmaz mely reakciók alkalmazásával állt elő. Azaz bármely $E_{i}, E_{j} \in \textit{EN}_{A}(S)$ ($E_{i} \neq E_{j}$) esetén
        \begin{align*}
            \bigcup\limits_{a \,\in\, E_{i}} P_{a} \neq \bigcup\limits_{b \,\in\, E_{j}} P_{b}.
        \end{align*}
    \end{lemma}

    \begin{proof}
        Legyen $\mathscr{A} = (S, A)$ egy \textit{reaction system}. Tegyük fel, hogy létezik $E_{i}, E_{j} \in \textit{EN}_{A}(S)$ ($E_{i} \neq E_{j}$) úgy, hogy
        \begin{align*}
            \bigcup\limits_{a \,\in\, E_{i}} P_{a} = \bigcup\limits_{b \,\in\, E_{j}} P_{b}.
        \end{align*}
        Ha $E_{i}, E_{j} \in \textit{EN}_{A}(S)$ és $E_{i} \neq E_{j}$, akkor biztosan léteznek olyan $W_{i}, W_{j} \subseteq S$ halmazok, hogy $\en_{A}(W_{i}) = E_{i}$, $\en_{A}(W_{j}) = E_{j}$ és $W_{i} \neq W_{j}$. Ugyanakkor, mivel
        \begin{align*}
            \bigcup\limits_{a \,\in\, E_{i}} P_{a} = \bigcup\limits_{b \,\in\, E_{j}} P_{b},
        \end{align*}
        ezért ez pontosan azt jelenti, hogy létezik $W_{i}, W_{j} \subseteq S$ ($W_{i} \neq W_{j}$) úgy, hogy
        \begin{align*}
            \res_{A}(W_{i}) = \res_{A}(W_{j}),
        \end{align*}
        azaz $\mathscr{A}$ nem reverzibilis.
    \end{proof}

    Az előbbi három lemma felhasználásával már felírhatunk egy olyan \textit{reaction systemet}, mely valóban megfelel a reverzibilitás definíciójának. A felírásban a második lemmát tekintve egy szigorúbb követelményt fogalmazunk meg: feltesszük, hogy a bemeneti elemek nem állíthatók elő semmilyen reakcióval (azaz $\Sigma_{p}$ és $\Sigma_{c}$ diszjunkt halmazok). Bár ez a feltétel nem következik egyértelműen a második lemmából, azonban jelentősen leegyszerűsíti a reverzibilitás bizonyítását.

    \begin{theorem}\label{the:reversible-reaction-system}
        Az $\mathscr{A} = (S, A)$ \textit{reaction system} reverzibilis, amennyiben a következő feltételek mindegyikének eleget tesz:
        \begin{enumerate}[label={(\arabic*)}]
            \item
            Az $A$ reakcióhalmaz elemei olyanok, hogy bármely \textit{interactive process} teljesíti az \ref{lem:no-disappearing-elements}. lemmát.

            \item
            Az $S$ halmaz két diszjunkt részhalmazból tevődik össze:
            \begin{align*}
                S = \Sigma_{p} \cup \Sigma_{c} \qquad \Sigma_{p} \cap \Sigma_{c} = \emptyset,
            \end{align*}
            mely halmazokra teljesül, hogy $\Sigma_{c} \cap \bigcup_{a \in A} P_{a} = \emptyset$ és $\Sigma_{p} \cap \bigcup_{0 \leq i \leq n} C_{i} = \emptyset$ bármely $\mathscr{A}$-beli $\pi$ \textit{interactive processre}. Ezáltal $\mathscr{A}$ teljesíti a \ref{lem:unique-results}. lemmát.

            \item
            Az $A$ reakcióhalmaz elemei olyanok, hogy bármely \textit{interactive process} teljesíti a \ref{lem:unique-products}. lemmát.
        \end{enumerate}
    \end{theorem}

    \begin{proof}
        Indirekt módon tegyük fel, hogy adott egy olyan $\mathscr{A}=(S, A)$ ($S = \Sigma_{p} \cup \Sigma_{c}$) \textit{reaction system}, mely megfelel az előbbi feltételeknek, azonban nem reverzibilis. Ekkor létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, mely nem reverzibilis. Ez azt jelenti, hogy a folyamat tartalmaz olyan $W \subseteq S$ állapotot, melyhez léteznek olyan $W_{i} \subseteq S$ és $W_{j} \subseteq S$ ($W_{i} \neq W_{j}$) halmazok, hogy
        \begin{align*}
            \res_{A}(W_{i}) \cup C &= W \\
            \res_{A}(W_{j}) \cup C &= W,
        \end{align*}
        ahol $C \subseteq S_{c}$ a $W$ állapothoz tartozó bemeneti halmaz. 
        
        Mivel mind $\res_{A}(W_{i}) \subseteq S_{d}$, mind $\res_{A}(W_{j}) \subseteq S_{d}$, ezért
        \begin{align*}
            \res_{A}(W_{i}) &= W \setminus C \\
            \res_{A}(W_{j}) &= W \setminus C, \\
        \end{align*}
        azaz
        \begin{align*}
            \res_{A}(W_{i}) = \res_{A}(W_{j}).
        \end{align*}

        Ez azt jelenti, hogy
        \begin{align*}
            \bigcup\limits_{a \,\in\, \en_{A}(W_{i})}P_{a} = \bigcup\limits_{a \,\in\, \en_{A}(W_{j})}P_{a}.
        \end{align*}

        $\mathscr{A}$ eleget tesz a fenti feltételeknek, ezért ilyen esetben
        \begin{align*}
            \en_{A}(W_{i}) = \en_{A}(W_{j}).
        \end{align*}

        Egy számítási lépésben egy adott állapothalmaz minden elemének részt kell vennie legalább egy reakcióban, azaz
        \begin{align*}
            \bigcup\limits_{a \,\in\, \en_{A}(W_{i})} R_{a} = W_{i}
        \end{align*}
        és
        \begin{align*}
            \bigcup\limits_{a \,\in\, \en_{A}(W_{j})} R_{a} = W_{j}.
        \end{align*}

        A bizonyítás elején feltettük, hogy $W_{i} \neq W_{j}$, amiből következően
        \begin{align*}
            \bigcup\limits_{a \,\in\, \en_{A}(W_{i})} R_{a} \neq \bigcup\limits_{a \,\in\, \en_{A}(W_{j})} R_{a}.
        \end{align*}

        Tudjuk, hogy $\en_{A}(W_{i}) = \en_{A}(W_{j})$, mely halmazt jelöljük $E$-vel. Ezt a megelőző kifejezésbe beírva kapjuk, hogy
        \begin{align*}
            \bigcup\limits_{a \,\in\, E} R_{a} \neq \bigcup\limits_{a \,\in\, E} R_{a}.
        \end{align*}
        
        Ez azonban ellentmondás, azaz $\mathscr{A}$ reverzibilis lesz.
    \end{proof}

    \section*{A reverzibilitás szimulálása}

    A következőkben szeretnénk olyan \textit{reaction systemet} felírni, mely képes egy másik \textit{reaction systemet} szimulálni, azaz pontosan olyan lépéseket tud mind előrefelé, mind hátrafelé tenni, melyek az eredeti, szimulált rendszerben is szabályosak lennének.
    
    Hasonlóan a reverzibilitáshoz, a szimuláció is kapcsolatban van a \textit{interactive processekkel}, melyek véges halmazsorozatokból állnak. Elősegítendő a későbbiek olvashatóságát, most bevezetünk néhány új jelölést véges halmazsorozatokra vonatkozóan.

    \begin{definition}
        Tegyük fel, hogy adott egy $n + 1$ halmazból álló véges $W=W_{0}, W_{1}, \ldots, W_{n}$ halmazsorozat. Ekkor a halmazsorozat $n + 1$ hosszát jelölje $|W|$.
    \end{definition}

    \begin{definition}
        Tegyük fel, hogy adottak a $V_{0}, V_{1}, \ldots, V_{n}$ ($n \geq 0$) véges halmazsorozatok. Ekkor az e halmazsorozatok összefűzésével kapott halmazsorozatot $W = V_{0}, V_{1}, \ldots, V_{n}$ módon jelöljük.
    \end{definition}

    \begin{definition}
        Tegyük fel, hogy adott egy $n + 1$ halmazból álló véges $W=W_{0}, W_{1}, \ldots, W_{n}$ halmazsorozat. Ekkor a $W$ halmazsorozat fordítottját $\backwardhat W$ módon jelöljük, ahol $\backwardhat W = W_{n}, W_{n - 1}, \ldots, W_{0}$.
    \end{definition}

    \begin{definition}
        Tegyük fel, hogy adott két véges halmazsorozat, $M$ és $W$, ahol $|M| \leq |W|$. Azt mondjuk, hogy $W$ tartalmazza $M$-et, ha $M$ összefüggő részsorozata $W$-nek, azaz létezik olyan $0 \leq i < |W|$, hogy $W_{j} = M_{j}$ ($i \leq j < i + |M|$). Ezt $M \subseteq W$ módon jelöljük.
    \end{definition}

    \begin{definition}
        Tegyük fel, hogy adott egy $n + 1$ halmazból álló véges $W=W_{0}, W_{1}, \ldots, W_{n}$ halmazsorozat, valamint egy $D$ véges halmaz. Jelölje ekkor $W \,\setminus\, D$ azt a véges halmazsorozatot, melyet úgy állítunk elő, hogy $W$ minden elemének vesszük a különbségét $D$-vel, azaz $W \,\setminus\, D = W_{0} \,\setminus\, D, W_{1} \,\setminus\, D, \ldots, W_{n} \,\setminus\, D$.
    \end{definition}

    \begin{remark*}
        A következőkben, akárhányszor azt a megállapítást tesszük, hogy létezik egy megfelelő $\mathscr{A}$-beli $\pi$ \textit{interactive process}, akkor ezalatt egy új, friss \textit{interactive processt} értünk, hacsak ezt külön nem jelezzük.
    \end{remark*}

    \begin{definition}\label{def:interactive-simulation}
        Legyen $\mathscr{A}$ és $\mathscr{B}$ két \textit{reaction system}. Azt mondjuk, hogy $\mathscr{B}$ interaktívan szimulálja $\mathscr{A}$ lépéseit, amennyiben a következő feltételek teljesülnek:
        \begin{itemize}
            \item
            Legyen $\pi$ egy tetszőleges \textit{interactive process} $\mathscr{A}$-ban. Ekkor létezik olyan $\sigma$ \textit{interactive process} $\mathscr{B}$-ben, hogy $\textit{sts}(\pi) \subseteq \textit{sts}(\sigma)$.

            \item
            Létezik végtelen sok olyan $\sigma = (\gamma, \delta)$ \textit{interactive process} $\mathscr{B}$-ben, hogy $\textit{sts}(\sigma)$ felírható a $V_{0}, V_{1}, \ldots, V_{k}$ ($k \leq n$) véges halmazsorozatok felhasználásával, $\textit{sts}(\sigma)=V_{0}, \ldots, V_{k}$ formában, ahol az egyes $V_{i}$ halmazsorozatokra a következők egyike teljesül:
            \begin{itemize}
                \item
                Létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $V_{0} \setminus \{ \, \rho \, \} = \textit{sts}(\pi)$.
                
                \item
                Ha $i = 2m$ ($m \geq 1$), akkor létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $V_{i} \,\setminus\, \{ \, \rho \, \}\subseteq \textit{sts}(\pi)$. 
                
                \item
                Ha $i = 2m + 1$ ($m \geq 0$), akkor minden $V_{i}$-beli $W_{j}$ halmazra teljesül, hogy $\rho \in W_{j}$, továbbá létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $\backwardhat V_{i} \,\setminus\, \{ \, \rho \, \} \subseteq \textit{sts}(\pi)$.
            \end{itemize}
            Továbbá, ha $\gamma = C_{0}, C_{1}, \ldots, C_{n}$ és $\delta = D_{0}, D_{1}, \ldots, D_{n}$, akkor tetszőleges $i = 0, 1, \ldots n$ esetén:
            \begin{itemize}
                \item
                Ha $D_{i} = \emptyset$ vagy $D_{i} \subseteq \Sigma_{c}$, akkor $\rho \notin C_{i}$.
                \item
                Ha $\rho \in C_{i}$, akkor $C_{i} = \{ \,\rho\, \}$.
            \end{itemize}

        \end{itemize}
        $\rho$ itt egy olyan segédszimbólum $\mathscr{B}$ háttérhalmazában (\textit{background set}), mely egy szimulált hátrafelé lépést vált ki.
    \end{definition}

    Vegyük észre, hogy a fenti definíció nem tartalmaz semmilyen megszorítást a szimulált rendszerre vonatkozóan. Ugyanakkor, ha feltesszük, hogy $\mathscr{A}$ egy olyan \textit{reaction system}, mely teljesíti az \ref{the:reversible-reaction-system}. tételt, akkor a definícióból további következtetéseket vonhatunk le.

    \begin{corollary*}
        Szimuláció esetén fennálhat az a probléma, hogy a szimuláló rendszer az eredeti rendszer kezdőállapotát megelőző állapotokba lép. Ezt érdemes elkerülni, hiszen így érvénytelen állapotokba léphet a szimuláló rendszer. Ha a szimulált rendszer teljesíti az \ref{the:reversible-reaction-system}. tételt, akkor ez nem lehetséges, hiszen a definíció tiltja a visszalépést kiváltó szimbólum megjelenését a kezdőállapotban, valamint az olyan állapotokban, amikor a kezdőállapotba léptünk vissza ($D_{i} \subseteq \Sigma_{c}$).
    \end{corollary*}

    \begin{corollary*}
        A definícióban a páratlan indexű $V_{i}$ halmazsorozatok jelölték a szimulált, visszafelé irányba tett lépéseket. Ha a szimulált rendszer teljesíti az \ref{the:reversible-reaction-system}. tételt, akkor minden állapothalmaz csak egyféleképpen állítható elő, valamint a reakciók nem állíthatják elő a bemeneti ábécé elemeit. Ennél fogva, egy páratlan indexű $V_{i}$ halmazsorozat akárhány elemből is áll, azok csak olyan, egymást követő állapothalmazok lehetnek, melyek korábban megjelentek szimulált előre irányba tett lépésként. Emellett, a $\rho$ szimbólumon felül hiába tartalmaznak az egyes bemeneti halmazok más, a bemeneti ábécében szereplő elemeket, azok nem befolyásolják a visszafelé szimulációt.
    \end{corollary*}

    A továbbiakban az \ref{the:reversible-reaction-system}. tételnek eleget tevő rendszerek szimulálását fogjuk tekinteni. Ezt megelőzően azonban bevezetünk néhány új jelölést, ismét az olvashatóság elősegítése érdekében.

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza. Vezessük be ekkor a következő halmazokat:
        \begin{align*}
            R_{A} &= \bigcup\limits_{a \,\in\, A} R_{a} \\
            P_{A} &= \bigcup\limits_{a \,\in\, A} P_{a}
        \end{align*}
        Tehát, ha adott egy $A$ reakcióhalmaz, akkor $R_{A}$ tartalmazza azokat az elemeket, melyek jelenléte szükséges ahhoz, hogy az $A$-beli összes reakció alkalmazható legyen. $P_{A}$ pedig azokból az elemekből áll, melyet az összes $A$-beli reakció egyidejű alkalmazásával kapunk.
    \end{definition}

    \begin{definition}
        Legyen $A$ reakciók egy véges halmaza, valamint $B \subseteq A$. Vezessük be ekkor a következő halmazt:
        \begin{align*}
            CONT_{A}(B) = \bigcup\limits_{\substack{A_{i} \subseteq A \\ P_{B} \subseteq P_{A_{i}}}} P_{A_{i}} \,\setminus\, P_{B}.
        \end{align*}
        Szemléletesen, megkeressük az összes olyan $A$-beli reakcióhalmazt, melynek produktuma bővebb, mint $B$ produktuma, és csak azokat a produktumelemeket tartjuk meg, melyeket $B$ nem állított elő.
    \end{definition}

    \begin{theorem}\label{the:simulating-a-reversible-reaction-system}
        Legyen $\mathscr{A}$ egy olyan reverzibilis \textit{reaction system}, mely eleget tesz az \ref{the:reversible-reaction-system}. tételnek. Ekkor felírható olyan \textit{reaction system} mely interaktívan szimulálja $\mathscr{A}$ lépéseit.
    \end{theorem}

    \begin{proof}
        A bizonyítás menete a következő. Először megkonstruálunk egy $\mathscr{B}$ \textit{reaction systemet} $\mathscr{A}$ alapján, a \ref{def:interactive-simulation}. definíciót szem előtt tartva. Ezután veszünk egy megfelelő $\sigma$ \textit{interactive processt} $\mathscr{B}$-ben, majd annak $\textit{sts}(\sigma)$ halmazsorozatát kisebb sorozatokra bontjuk, bebizonyítva az egyes sorozatokról, hogy eleget tesznek a szimulációra vonatkozó definíció feltételeinek. Ennek részeként először bizonyítjuk, hogy $\textit{sts}(\sigma)=V_{0}$ vagy $\textit{sts}(\sigma)=V_{0}V_{1}$, ahol $V_{0}$ egy olyan véges halmazsorozat, melyhez felírható egy $\mathscr{A}$-beli $\pi$ \textit{interactive process} úgy, hogy $V_{0} \setminus \{ \, \rho \, \} = \textit{sts}(\pi)$. Itt egyúttal azt is bizonyítjuk, hogy tetszőleges $\mathscr{A}$-beli \textit{interactive process} felírható $\mathscr{B}$-ben is. Továbblépve, belátjuk, hogy ha $\sigma$-ra teljesül hogy $\textit{sts}(\sigma)=V_{0}V_{1}$, ahol $V_{0}$ megfelel az előző feltételnek, akkor $V_{1}$ felírható $V_{1}=V_{2}$ vagy $V_{1}=V_{2}V_{3}$ alakban, ahol $V_{2}$ egy olyan véges halmazsorozat, melyhez létezik egy $\mathscr{A}$-beli $\pi$ \textit{interactive process} úgy, hogy $\backwardhat V_{2} \setminus \{ \,\rho\, \} \subseteq \textit{sts}(\pi)$. Végül megmutatjuk, hogy $V_{3}$ további felbontásaira már analóg módon bizonyítható, hogy teljesítik a feltételeket.

        \paragraph{$\mathscr{B}$ felírása}
        Tegyük fel, hogy adott az $\mathscr{A} = (S, A)$ ($S = \Sigma_{p} \cup \Sigma_{c}$) reverzibilis \textit{reaction system}, mely eleget tesz az \ref{the:reversible-reaction-system}. tételnek.
        
        Konstruáljuk meg ekkor a $\mathscr{B} = (T, B)$ \textit{reaction systemet} a következőképpen. Legyen $T = \Sigma_{p}^{\prime} \cup \Sigma^{\prime}_{c}$, ahol
        \begin{align*}
            \Sigma^{\prime}_{p} &= \Sigma_{p} \cup \Sigma_{c} \\
            \Sigma^{\prime}_{c} &= \Sigma_{c} \cup \{ \, \rho \, \}.
        \end{align*}
        A reakciók $B$ halmaza legyen $B = \forwardhat B \cup \backwardhat B$, ahol
        \begin{align*}
            \forwardhat B &= \{ \, \reaction{R_{a}}{I_{a} \cup \{ \, \rho \, \}}{P_{a}} \;|\; a \in A \, \} \\
            \backwardhat B &= \{ \reaction{P_{A_{i}} \cup \{ \rho \}}{CONT_{A}(A_{i})}{R_{A_{i}}} \;|\; A_{i} \subseteq \textit{EN}_{A}(S) \}.
        \end{align*}

        $\forwardhat B$ tartalmazza a szimulált rendszer előrefelé tett lépéseit megvalósító reakciókat, míg $\backwardhat B$ a visszafelé irányba tett lépések szimulálására alkalmas reakciókból áll. Ezek ilyen felírásának miértjét a bizonyítás további részeiben fogjuk ismertetni.
        
        \paragraph{Az \textit{interactive processek} felbontása}
        Vegyünk egy olyan $\sigma = (\gamma, \delta)$ \textit{interactive processt} $\mathscr{B}$-ben, mely  eleget tesz a \ref{def:interactive-simulation}. definíció bemeneti halmazokra vonatkozó feltételeinek. Rögzítsük továbbá, hogy $\gamma = C_{0}, C_{1}, \ldots, C_{n}$, $\delta = D_{0}, D_{1}, \ldots, D_{n}$ és $\textit{sts}(\pi) = W_{0}, W_{1}, \ldots, W_{n}$ ($n \in \mathbb{N}$). $\mathscr{B}$ felírásából adódóan, biztosan végtelen sok ilyen \textit{interactive process} létezik. Lássuk be $\sigma$ felbontásán keresztül, hogy $\mathscr{B}$ egy olyan \textit{reaction system}, mely interaktívan szimulálja $\mathscr{A}$ lépéseit!

        \subparagraph{Bizonyítás a kezdeti, előrelépő szakaszra}
        Mivel $\sigma$-t megfelelően választottuk, ezért biztos hogy valamely $0 \leq m_{0} \leq n$ értékre $\rho \notin C_{i}$ ($i = 0, 1, \ldots, m_{0}$). Azaz $\sigma$ egy olyan, legalább egyelemű állapothalmaz-sorozattal fog kezdődni, hogy a bemenetek között $\rho$ nem jelenik meg.
        
        Teljes indukcióval bizonyítsuk, hogy ekkor létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $\textit{sts}(\pi) = W_{0}, W_{1}, \ldots, W_{m_{0}}$, ha $m_{0} = n$, vagy $\textit{sts}(\pi) = W_{0}, W_{1}, \ldots, W_{m_{0}}, W_{m_{0} + 1} \setminus \{ \,\rho\,\}$, ha $m_{0} < n$. Utóbbi esetben $\rho$ eltávolítása a rákövetkező elemből azért szükséges, mert csak $m_{0}$-ig tettük fel, hogy $\rho$ nem szerepel a bemeneti halmazokban. Tehát az $m_{0}+1$-edik bemenetben már szerepelhet, viszont $\rho$ kivételével az így kapott állapot még mindig megjelenhetne valamilyen $\mathscr{A}$-beli \textit{interactive processben} is.
        
        A $\mathscr{B}$-beli szimuláló \textit{interactive processek} bemeneti halmazaira vonatkozó megszorítások miatt a $C_{0}$ bemeneti halmaz olyan, hogy $\rho \notin C_{0}$, azaz $C_{0} \subseteq \Sigma_{c}$. Emiatt $\sigma$ $W_{0}$ kezdőállapota biztosan szerepel valamilyen $\pi$ $\mathscr{A}$-beli \textit{interactive process} kezdőállapotaként. Ebből következik, hogy $m_{0} = 0$-ra a megelőző állítás biztosan igaz.
        
        Tegyük fel, hogy $m_{0} = k$-ra igaz az állítás, és ezt felhasználva lássuk be az $m_{0} = k + 1$ esetet! Ekkor tudjuk, hogy létezik olyan $\pi$ \textit{interactive proces} $\mathscr{A}$-ban, hogy $\textit{sts}(\pi) = W_{0}, W_{1}, \ldots, W_{k}$. Ez csak akkor lehetséges, ha $\rho \notin W_{k}$. Ekkor viszont $W_{k} \subseteq S$. Tekintsük most az erre a halmazra alkalmazható reakciókat! Mivel $\rho \notin W_{k}$, ezért csak $\forwardhat B$-beli reakciók lehetnek alkalmazhatók, hiszen $\rho$ minden $\backwardhat B$-beli reakció reagensei között szerepel. Vegyük észre, hogy $\forwardhat B$ pontosan ugyanazokat a reakciókat tartalmazza, mint $A$, azzal a különbséggel, hogy az egyes \textit{inhibitor} halmazok ki lettek bővítve a $\rho$ elemmel. Mivel $\rho \notin W_{k}$, ezért ebben az esetben $\rho$ irreleváns lesz, amiből következik, hogy $\res_{\mathscr{A}}(W_{k}) = \res_{\mathscr{B}}(W_{k}) = D_{k + 1}$. Tehát azt már biztosan állíthatjuk, hogy létezik olyan $\pi = (\gamma_{\pi}, \delta_{\pi})$ \textit{interactive proces} $\mathscr{A}$-ban, hogy $\delta_{\pi} = D_{1}, D_{2}, \ldots D_{k}, D_{k + 1}$. Lássuk most a bemenetet! Tudjuk, hogy $\rho \notin C_{k + 1}$. Mivel $D_{k + 1} \subseteq S$ és $C_{k + 1} \subseteq S$, ezért ekkor $W_{k + 1} \subseteq S$, továbbá létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $\textit{sts}(\pi)=W_{0}, W_{1}, \ldots, W_{k + 1}$.

        Végül az előző levezetést ki kell egészíteünk a továbblépésre vonatkozóan, azaz, hogy mi történik, ha $m_{0} = k + 1 < n$, tehát a rákövetkező halmaz már egy visszalépő sorozat kezdő eleme. Ekkor biztos, hogy $C_{m_{0} + 1} = \{\,\rho\,\}$. Azonban, mivel beláttuk, hogy van olyan $\mathscr{A}$-beli \textit{interactive process}, melynek állapothalmaz-sorozata pontosan a $W_{0}, W_{1}, \ldots, W_{m_{0}}$ halmazsorozattal esik egybe, ezért annak is teljesülnie kell, hogy ezt kiegészítve a $W_{m_{0} + 1} = \res_{\mathscr{A}}(W_{m_{0}}) \cup \{\,\rho\,\}$ halmazzal, lennie kell olyan $\mathscr{A}$-beli \textit{interactive processnek} is, melynek állapothalmaz-sorozata a $W_{0}, W_{1}, \ldots, W_{m_{0}}, W_{m_{0} + 1} \setminus \{\,\rho\,\}$ halmazsorozattal egyezik meg.

        Vagyis az állítás teljesül $m_{0} = k + 1$-re is. Vegyük észre, hogy ezzel azt is bizonyítottuk, hogy bármely $\mathscr{A}$-beli \textit{interactive process} megjelenik $\mathscr{B}$-ben is, hiszen mind a $C_{i}$ bemeneti halmazok, mind a kezdeti előrelépő halmazsorozat hosszát leíró $k$ teszőlegesek. Azaz $\mathscr{B}$ teljesíti a szimulációra vonatkozó definíció első feltételét.

        %A későbbiek szempontjából fontos kiemelni azt is, hogy egyúttal azt is bizonyítottuk, hogy a tetszőlegesen megválasztott $\sigma$ \textit{interactive process} állapothalmaz-sorozata mindig egy olyan $V_{0}$ halmazsorozattal kezdődik, melyre igaz, hogy $V_{0} \subseteq \textit{sts}(\pi)$, valamilyen $\pi$ $\mathscr{A}$-beli \textit{interactive processre}.
        \subparagraph{Bizonyítás a következő, visszalépő szakaszra}
        Lépjünk tovább, és tegyük fel, hogy $m_{0} < n$. Ekkor biztos, hogy valamely $m_{0} < m_{1} \leq n$ értékre $\rho \in C_{i}$ ($i = m_{0} + 1, m_{0} + 2, \ldots, m_{1}$). Ugyanis azt tettük fel, hogy $m_{0}$-ig egy bemenet sem tartalmazza $\rho$-t. Így szükségszerűen, ha nem értünk el $n$-ig, akkor egy vagy több olyan bemeneti halmaznak kell következnie, melyben megjelenik $\rho$.
        
        Teljes indukciót használva bizonyítsuk, hogy ekkor létezik olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy a $V_{1} = W_{m_{0} + 1}, W_{m_{0} + 2}, \ldots, W_{m_{1}}$ halmazsorozatra teljesül, hogy $\backwardhat V_{1} \setminus \{\, \rho \,\} \subseteq \textit{sts}(\pi)$.

        Először tekintsük az indukció első lépését, azaz bizonyítsuk a fenti állítást $m_{1} = m_{0} + 1$-re, egy egyelemű halmazsorozatra. Tudjuk ekkor, hogy $\rho \in C_{m_{1}}$, ezen felül az előző bizonyításból adódik, hogy biztosan létezik olyan $\pi$ \textit{interactive proces} $\mathscr{A}$-ban, hogy $\textit{sts}(\pi) = W_{0}, W_{1}, \ldots W_{m_{0} + 1} \setminus \{\,\rho\,\}$. Azaz, ha $V_{1} = W_{m_{1}}$, akkor biztos, hogy $\backwardhat V_{1} \setminus \{\,\rho\,\} \subseteq \textit{sts}(\pi)$. Tehát $m_{1} = m_{0} + 1$-re igaz az állítás.
        
        Most tegyük fel, hogy $m_{1} = m_{0} + k$-ra igaz az állítás, és ezt felhasználva lássuk be az $m_{1} = m_{0} + k + 1$ esetet! Ekkor tudjuk, hogy a $V_{2} = W_{m_{0} + 1}, W_{m_{0} + 2}, \ldots W_{m_{0} + k}$ halmazsorozatra teljesül, hogy $\backwardhat V_{2} \setminus \{ \, \rho \, \} \subseteq \textit{sts}(\pi)$ valamilyen $\pi$ \textit{interactive processre} $\mathscr{A}$-ban, továbbá, hogy $C_{m_{0} + k} = \{ \, \rho \, \}$ és $C_{m_{1}} = \{ \, \rho \,\}$.
        
            
        Ezek ismeretében már felírható $W_{m_{1}}$. Mivel $\rho \in W_{m_{0} + k}$, ezért biztos, hogy csak $\backwardhat B$-beli reakciók lehetnek alkalmazhatók $W_{m_{0} + k}$-ra, hiszen $\rho$ tiltja a $\forwardhat B$-beli reakciók alkalmazását. $\mathscr{A}$ reverzibilis, ezért egyértelmű, hogy egy $D$ eredményhalmaz mely $A_{i} \subseteq A$ reakcióhalmaz alkalmazásával állt elő. Ez azt jelenti, hogy tetszőleges $D$ alapján visszaállítható az a $W$ halmaz, melyre teljesül, hogy $\res_{\mathscr{A}}(W)=D$. Csupán össze kell fognunk az $A_{i}$-beli reakciókat, és elkészíteni egy olyan új reakciót, melynek reagens halmaza $D = P_{A_{i}}$, produktum halmaza pedig $W = R_{A_{i}}$. Vigyáznunk kell azonban arra, hogy ha létezik egy vagy több olyan $A_{j} \subseteq A$ halmaz, hogy $P_{A_{i}} \subset P_{A_{j}}$, akkor az összes $P_{A_{j}} \setminus P_{A_{i}}$-beli elem bekerüljön az új reakció \textit{inhibitor} halmazába. Ezzel kizárjuk ugyanis azt, hogy ha a bővebb halmazt látjuk, akkor arra alkalmazzuk a részhalmazra vonatkozó reakciót is. Vegyük észre, hogy $\backwardhat B$ pontosan ilyen módszerrel képzett reakciókat tartalmaz. Most már csak meg kell keresnünk azt a reakciót, mely alkalmazható $W_{m_{0} + k}$-ra. Ilyen reakció mindig egyértelműen létezik: egyértelmű, hiszen $\mathscr{A}$ reverzibilis, azaz minden eredményhalmaz csak egyféleképpen állítható elő, és létezik, mert $\backwardhat V_{2} \setminus \{ \, \rho \, \} \subseteq \textit{sts}(\pi)$ valamilyen $\pi$ \textit{interactive processre} $\mathscr{A}$-ban, azaz $\backwardhat V_{2} \setminus \{\,\rho\,\}$ első eleme ($W_{m_{0} + k} \setminus \{\,\rho\,\}$) biztosan valamilyen állapothalmazból állt elő, valamilyen $A$-beli reakciók alkalmazásával. Az jelenthetne problémát, ha $W_{m_{0} + k} \setminus \{\,\rho\,\}$ egy kezdőállapot lenne, azonban ezt az esetet a bemeneti halmazokra tett megszorítások kizárják.

        Tehát $W_{m_{0} + k}$-ra csak az az egyértelműen létező $b \in \backwardhat B$ reakció lesz alkalmazható, amelyre teljesül, hogy $P_{b} = W_{m_{0} + k} \setminus \{ \,  \rho \, \}$.  Ezt a reakciót a $P_{b} = W_{m_{0} + k} \setminus \{ \,  \rho \, \}$ halmazva alkalmazva egy olyan $R_{b} = D_{m_{1}}$ halmazt kapunk, hogy $\res_{\mathscr{A}}(D_{m_{1}}) = W_{m_{0} + k} \setminus \{ \,  \rho \, \}$. Mivel $C_{m_{1}} = \{\,\rho\,\}$, ezért $W_{m_{1}} = R_{b} \cup \{ \, \rho \, \}$. Ez pedig pontosan azt jelenti, hogy ezek az állapothalmazok felírhatók egy olyan $V_{3} = W_{m_{0} + 1}, W_{m_{0} + 2}, \ldots, W_{m_{0} + k}, W_{m_{1}}$ halmazsorozat formájában, melyre teljesül, hogy $\backwardhat V_{3} \setminus \{ \,  \rho \, \} \subseteq \textit{sts}(\pi)$ valamilyen $\pi$ \textit{interactive processre} $\mathscr{A}$-ban, hiszen $V_{3}$ lényegében $V_{2}$ megfelelő folytatása, melyről már beláttuk, hogy ugyanezt teljesíti.

        \subparagraph{Analógia bizonyítása a további szakaszokra}
        Végül már csak azt kell bizonyítanunk, hogy ha $m_{1} < n$, akkor a fenti két esethez képest analóg módon bizonyítható, hogy megfelelő halmazsorozatok alkotják $\sigma$ fennmaradó részét. 

        Ekkor tudjuk, hogy $C_{m_{1}} = \{\,\rho\,\}$ és $\rho \notin C_{m_{1} + 1}$. Előbbi következménye, hogy $D_{m_{1} + 1}$ egy szimulált visszafelé lépés eredményeként áll elő, azaz teljesül rá, hogy $\res_{\mathscr{A}}(D_{m_{1} + 1}) = W_{m_{1}} \setminus \{\,\rho\,\}$. Ekkor $W_{m_{1} + 1} = D_{m_{1} + 1} \cup C_{m_{1} + 1}$. Mivel a $V_{4} = W_{m_{0} + 1}, W_{m_{0} + 2}, \ldots W_{m_{1}}, D_{m_{1} + 1}$ halmazsorozata teljesül, hogy van olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $\backwardhat V_{4} \setminus \{\,\rho\,\} \subseteq \textit{sts}(\pi)$, ezért $D_{m_{1} + 1}$-re vonatkozóan két lehetőség áll fenn:
        \begin{itemize}
            \item
            $D_{m_{1} + 1} \subseteq \Sigma_{c}$, azaz $D_{m_{1} + 1}$ $\pi$ kezdőállapotával egyezik meg, vagy
        
            \item
            létezik olyan $W$ állapot $\pi$-ben, hogy $D_{m_{1} + 1} \setminus \Sigma_{c} = \res_{\mathscr{A}}(W)$.
        \end{itemize}
        Bármely esetet is tekintjük, a $V_{5} = D_{m_{1} + 1}$ halmazsorozatról biztosan állítható, hogy része $\pi$ állapothalmaz-sorozatának. Mivel $W_{m_{1} + 1}$-ben $D_{m_{1} + 1}$-et csak $\Sigma_{c}$-beli elemekkel egészíthetjük ki, ezért lesz olyan $\tau$ \textit{interactive process} is $\mathscr{A}$-ban, melynek állapothalmaz-sorozata tartalmazza $W_{m_{1} + 1}$-et. Ekkor viszont, az előrelépésre vonatkozó teljes indukciót felhasználva, ha a rákövetkező bemenetek sem tartalmazzák a $\rho$ elemet, akkor az így elkezdett halmazsorozat továbbra is megfelelő marad (azaz lesz olyan $\mathscr{A}$-beli \textit{interactive process}, melynek állapothalmaz-sorozata őt tartalmazza).
        %Ekkor két eset lehetséges:
        %\begin{itemize}
         %   \item
          %  Ha $C_{m_{1} + 1} = \emptyset$, akkor $W_{m_{1} + 1} = D_{m_{1} + 1}$. De akkor $W_{m_{1} + 1} = W_{m_{1}} \setminus \{\,\rho\,\}$. Mivel a $V_{1} = W_{m_{0} + 1}, W_{m_{0} + 2}, \ldots W_{m_{1}}, W_{m_{1} + 1}$ halmazsorozata teljesül, hogy van olyan $\pi$ \textit{interactive process} $\mathscr{A}$-ban, hogy $\backwardhat V_{1} \setminus \{\,\rho\,\} \subseteq \textit{sts}(\pi)$, ezért a $V_{2} = W_{m_{1} + 1}$ halmazsorozatról biztosan állítható, hogy $V_{2} \subseteq \textit{sts}(\pi)$. Ekkor viszont, az előrelépésre vonatkozó teljes indukciót felhasználva, ha a rákövetkező bemenetek sem tartalmazzák a $\rho$ elemet, akkor $V_{2}$ továbbra is megfelelő marad (azaz lesz olyan $\mathscr{A}$-beli \textit{interactive process}, melynek állapothalmaza őt tartalmazza).
        %\end{itemize}
        
        Ezt követően, ha valamely $C_{j}$ bemeneti halmaz tartalmazza a $\rho$ elemet, akkor ugyanazon indukció lenne alkalmazható, mint az első visszalépő szakaszra vonatkozóan: kiindulva egy olyan halmazból, mely biztosan megjelenik egy $\mathscr{A}$-beli \textit{interactive process} állapothalmazsorozat elemként, beláthatjuk, hogy csak megfelelő visszafelé lépéseket tudunk szimulálni.
        
        \paragraph{Konklúzió}
        Végiglépve $\sigma$ állapothalmazainak felbontásán, láttuk, hogy $\sigma$ megfelel a szimulációs definíció feltételeinek. Tudjuk továbbá, hogy végtelen sok ilyen $\sigma$ \textit{interactive process} írható fel $\mathscr{B}$-ben. Ezen felül azt is láttuk, hogy bármely $\mathscr{A}$-beli \textit{interactive process} felírható $\mathscr{B}$-ben is. Ezek együttesen azt jelentik, hogy $\mathscr{B}$ interaktívan szimulálja $\mathscr{A}$-t.
    \end{proof}
\end{document}
